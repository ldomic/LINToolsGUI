function atomInfo(callback){
  // List ligands
  request = $.ajax({
    url:"/atomData",
    method: "POST",
    dataType: 'json',
    success: function(d){callback(d)}
  })
}
var atomInfoData;
atomInfo(function (d){atomInfoData = d.atomData;});

d3Context = d3.select(document.getElementById("svg1").contentDocument);
$("#GC").on("click", function(d){
  var scale = scales["viridis"];
  var colorScale = d3.scaleLinear()
       .domain([-0.31      , -0.30878431, -0.30756863, -0.30635294, -0.30513725,
       -0.30392157, -0.30270588, -0.3014902 , -0.30027451, -0.29905882,
       -0.29784314, -0.29662745, -0.29541176, -0.29419608, -0.29298039,
       -0.29176471, -0.29054902, -0.28933333, -0.28811765, -0.28690196,
       -0.28568627, -0.28447059, -0.2832549 , -0.28203922, -0.28082353,
       -0.27960784, -0.27839216, -0.27717647, -0.27596078, -0.2747451 ,
       -0.27352941, -0.27231373, -0.27109804, -0.26988235, -0.26866667,
       -0.26745098, -0.26623529, -0.26501961, -0.26380392, -0.26258824,
       -0.26137255, -0.26015686, -0.25894118, -0.25772549, -0.2565098 ,
       -0.25529412, -0.25407843, -0.25286275, -0.25164706, -0.25043137,
       -0.24921569, -0.248     , -0.24678431, -0.24556863, -0.24435294,
       -0.24313725, -0.24192157, -0.24070588, -0.2394902 , -0.23827451,
       -0.23705882, -0.23584314, -0.23462745, -0.23341176, -0.23219608,
       -0.23098039, -0.22976471, -0.22854902, -0.22733333, -0.22611765,
       -0.22490196, -0.22368627, -0.22247059, -0.2212549 , -0.22003922,
       -0.21882353, -0.21760784, -0.21639216, -0.21517647, -0.21396078,
       -0.2127451 , -0.21152941, -0.21031373, -0.20909804, -0.20788235,
       -0.20666667, -0.20545098, -0.20423529, -0.20301961, -0.20180392,
       -0.20058824, -0.19937255, -0.19815686, -0.19694118, -0.19572549,
       -0.1945098 , -0.19329412, -0.19207843, -0.19086275, -0.18964706,
       -0.18843137, -0.18721569, -0.186     , -0.18478431, -0.18356863,
       -0.18235294, -0.18113725, -0.17992157, -0.17870588, -0.1774902 ,
       -0.17627451, -0.17505882, -0.17384314, -0.17262745, -0.17141176,
       -0.17019608, -0.16898039, -0.16776471, -0.16654902, -0.16533333,
       -0.16411765, -0.16290196, -0.16168627, -0.16047059, -0.1592549 ,
       -0.15803922, -0.15682353, -0.15560784, -0.15439216, -0.15317647,
       -0.15196078, -0.1507451 , -0.14952941, -0.14831373, -0.14709804,
       -0.14588235, -0.14466667, -0.14345098, -0.14223529, -0.14101961,
       -0.13980392, -0.13858824, -0.13737255, -0.13615686, -0.13494118,
       -0.13372549, -0.1325098 , -0.13129412, -0.13007843, -0.12886275,
       -0.12764706, -0.12643137, -0.12521569, -0.124     , -0.12278431,
       -0.12156863, -0.12035294, -0.11913725, -0.11792157, -0.11670588,
       -0.1154902 , -0.11427451, -0.11305882, -0.11184314, -0.11062745,
       -0.10941176, -0.10819608, -0.10698039, -0.10576471, -0.10454902,
       -0.10333333, -0.10211765, -0.10090196, -0.09968627, -0.09847059,
       -0.0972549 , -0.09603922, -0.09482353, -0.09360784, -0.09239216,
       -0.09117647, -0.08996078, -0.0887451 , -0.08752941, -0.08631373,
       -0.08509804, -0.08388235, -0.08266667, -0.08145098, -0.08023529,
       -0.07901961, -0.07780392, -0.07658824, -0.07537255, -0.07415686,
       -0.07294118, -0.07172549, -0.0705098 , -0.06929412, -0.06807843,
       -0.06686275, -0.06564706, -0.06443137, -0.06321569, -0.062     ,
       -0.06078431, -0.05956863, -0.05835294, -0.05713725, -0.05592157,
       -0.05470588, -0.0534902 , -0.05227451, -0.05105882, -0.04984314,
       -0.04862745, -0.04741176, -0.04619608, -0.04498039, -0.04376471,
       -0.04254902, -0.04133333, -0.04011765, -0.03890196, -0.03768627,
       -0.03647059, -0.0352549 , -0.03403922, -0.03282353, -0.03160784,
       -0.03039216, -0.02917647, -0.02796078, -0.0267451 , -0.02552941,
       -0.02431373, -0.02309804, -0.02188235, -0.02066667, -0.01945098,
       -0.01823529, -0.01701961, -0.01580392, -0.01458824, -0.01337255,
       -0.01215686, -0.01094118, -0.00972549, -0.0085098 , -0.00729412,
       -0.00607843, -0.00486275, -0.00364706, -0.00243137, -0.00121569,  0.        ])
       .range(scale);
  d3Context.selectAll('ellipse').each(function(d) {
       var x_coord = d3.select(this).attr("cx");
       var y_coord = d3.select(this).attr("cy");
       for (atom of atomInfoData){
         if (x_coord == atom.coords[0] && y_coord == atom.coords[1]){
           d3.select(this).style('fill', function() {
                return colorScale(atom.GasteigerCh);
            })
         }
       };
    });

  });
  $("#logP").on("click", function(d){
    var scale = scales["spectral8"];
    var colorScale = d3.scaleLinear()
         .domain([-0.32      , -0.23571429, -0.15142857, -0.06714286,  0.01714286,
        0.10142857,  0.18571429,  0.27      ])
         .range(scale);
    d3Context.selectAll('ellipse').each(function(d) {
         var x_coord = d3.select(this).attr("cx");
         var y_coord = d3.select(this).attr("cy");
         for (atom of atomInfoData){
           if (x_coord == atom.coords[0] && y_coord == atom.coords[1]){
             d3.select(this).style('fill', function() {
                  return colorScale(atom.logP);
              })
           }
         };
      });

    });
  $("#MR").on("click", function(d){
    var scale = scales["spectral8"];
    var colorScale = d3.scaleLinear()
         .domain([ 1.8  ,  2.051,  2.302,  2.553,  2.804,  3.055,  3.306,  3.557,
        3.808,  4.059,  4.31 ])
         .range(scale);
    d3Context.selectAll('ellipse').each(function(d) {
         var x_coord = d3.select(this).attr("cx");
         var y_coord = d3.select(this).attr("cy");
         for (atom of atomInfoData){
           if (x_coord == atom.coords[0] && y_coord == atom.coords[1]){
             d3.select(this).style('fill', function() {
                  return colorScale(atom.MR);
              })
           }
         };
      });

    });
    $("#Clear").on("click", function(d){
      d3Context.selectAll('ellipse').each(function(d) {
          d3.select(this).style('fill',"white");
        });

      });
  var scales = {
      'puOr11': ['#7f3b08', '#b35806', '#e08214', '#fdb863', '#fee0b6', '#f7f7f7', '#d8daeb', '#b2abd2', '#8073ac', '#542788', '#2d004b'],
      'spectral8': ['#d53e4f', '#f46d43', '#fdae61', '#fee08b', '#e6f598', '#abdda4', '#66c2a5', '#3288bd'],
      'redBlackGreen': ['#ff0000', '#AA0000', '#550000', '#005500', '#00AA00', '#00ff00'],
      'viridis': ["#440154","#440256","#450457","#450559","#46075a","#46085c","#460a5d","#460b5e","#470d60","#470e61","#471063","#471164","#471365","#481467","#481668","#481769","#48186a","#481a6c","#481b6d","#481c6e","#481d6f","#481f70","#482071","#482173","#482374","#482475","#482576","#482677","#482878","#482979","#472a7a","#472c7a","#472d7b","#472e7c","#472f7d","#46307e","#46327e","#46337f","#463480","#453581","#453781","#453882","#443983","#443a83","#443b84","#433d84","#433e85","#423f85","#424086","#424186","#414287","#414487","#404588","#404688","#3f4788","#3f4889","#3e4989","#3e4a89","#3e4c8a","#3d4d8a","#3d4e8a","#3c4f8a","#3c508b","#3b518b","#3b528b","#3a538b","#3a548c","#39558c","#39568c","#38588c","#38598c","#375a8c","#375b8d","#365c8d","#365d8d","#355e8d","#355f8d","#34608d","#34618d","#33628d","#33638d","#32648e","#32658e","#31668e","#31678e","#31688e","#30698e","#306a8e","#2f6b8e","#2f6c8e","#2e6d8e","#2e6e8e","#2e6f8e","#2d708e","#2d718e","#2c718e","#2c728e","#2c738e","#2b748e","#2b758e","#2a768e","#2a778e","#2a788e","#29798e","#297a8e","#297b8e","#287c8e","#287d8e","#277e8e","#277f8e","#27808e","#26818e","#26828e","#26828e","#25838e","#25848e","#25858e","#24868e","#24878e","#23888e","#23898e","#238a8d","#228b8d","#228c8d","#228d8d","#218e8d","#218f8d","#21908d","#21918c","#20928c","#20928c","#20938c","#1f948c","#1f958b","#1f968b","#1f978b","#1f988b","#1f998a","#1f9a8a","#1e9b8a","#1e9c89","#1e9d89","#1f9e89","#1f9f88","#1fa088","#1fa188","#1fa187","#1fa287","#20a386","#20a486","#21a585","#21a685","#22a785","#22a884","#23a983","#24aa83","#25ab82","#25ac82","#26ad81","#27ad81","#28ae80","#29af7f","#2ab07f","#2cb17e","#2db27d","#2eb37c","#2fb47c","#31b57b","#32b67a","#34b679","#35b779","#37b878","#38b977","#3aba76","#3bbb75","#3dbc74","#3fbc73","#40bd72","#42be71","#44bf70","#46c06f","#48c16e","#4ac16d","#4cc26c","#4ec36b","#50c46a","#52c569","#54c568","#56c667","#58c765","#5ac864","#5cc863","#5ec962","#60ca60","#63cb5f","#65cb5e","#67cc5c","#69cd5b","#6ccd5a","#6ece58","#70cf57","#73d056","#75d054","#77d153","#7ad151","#7cd250","#7fd34e","#81d34d","#84d44b","#86d549","#89d548","#8bd646","#8ed645","#90d743","#93d741","#95d840","#98d83e","#9bd93c","#9dd93b","#a0da39","#a2da37","#a5db36","#a8db34","#aadc32","#addc30","#b0dd2f","#b2dd2d","#b5de2b","#b8de29","#bade28","#bddf26","#c0df25","#c2df23","#c5e021","#c8e020","#cae11f","#cde11d","#d0e11c","#d2e21b","#d5e21a","#d8e219","#dae319","#dde318","#dfe318","#e2e418","#e5e419","#e7e419","#eae51a","#ece51b","#efe51c","#f1e51d","#f4e61e","#f6e620","#f8e621","#fbe723","#fde725"]
  };
